---
import { getCollection } from 'astro:content';
import BaseLayout from '../../../components/BaseLayout.astro';
import { LABELS } from '../labels';

export async function getStaticPaths() {
    const entries = await getCollection('ja');

    const categories = [
        ...new Set(
        entries.map(e => e.slug.split('/')[0])
        )
    ];

    return categories.map(category => ({
        params: { category }
    }));
}

const { category } = Astro.params;

const entries = await getCollection('ja', ({ slug }) =>
    slug.startsWith(`${category}/`)
);

const subcategories = [
    ...new Set(
        entries.map(e => e.slug.split('/')[1])
    )
];
---
<BaseLayout lang="ja" type="website" title={LABELS[category]} description={`${LABELS[category]}`}>
    <h1>{LABELS[category]}</h1>
    <ul>
        {subcategories.map(sub => (
            <li>
            <a href={`/ja/${category}/${sub}/`}>
                {LABELS[sub]}
            </a>
            </li>
        ))}
    </ul>
</BaseLayout>